---
title: "Coronavirus COVID-19 (2019-nCoV) statistics in Baltic states"
output:
  html_document:
    toc: true
    toc_depth: 2
    number_sections: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    fig_width: 16
    fig_height: 9
    fig_caption: true
    theme: flatly
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse = TRUE, error = TRUE, warning = FALSE, message = FALSE)
```

```{r, include=FALSE}
# loading packets that are needed for running the .Rmd 
source("./scripts/loading_R_packets.R")
```

```{r, include=FALSE}
# importing JHCSSE and LT data, data preparation
source("./scripts/data_import_preparation_word.R")
source("./scripts/data_import_preparation_word_map.R")
source("./scripts/data_import_preparation_LT.R")
```


```{r, include=FALSE}
# todo
# reikia importą zipo ir failo paėmimą iš zipo padaryt, nes dabar iš working directory ima

# INFO:
# https://www.naturalearthdata.com/downloads/50m-cultural-vectors/50m-admin-0-countries-2

# URL <- "https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/cultural/ne_50m_admin_0_sovereignty.zip"
# download.file(url=URL, destfile ="./data/ne_50m_admin_0_sovereignty.zip", method = "auto")
# unzip("./data/ne_50m_admin_0_sovereignty.zip", exdir = "./data/")
# countries <- readOGR(dsn="./data/ne_50m_admin_0_sovereignty.shp",
#                              encoding = "utf-8",
#                              use_iconv = T,
#                              verbose = FALSE,
#                      stringsAsFactors = FALSE)
#  countries <- st_as_sf(countries)
#  ggplot(countries)+ geom_sf()

```



# Įvadas
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam convallis mauris id commodo rutrum. Ut ultrices, nisl non maximus pulvinar, risus risus vehicula nulla, ullamcorper lacinia orci ligula ac neque. Suspendisse lacinia, erat vitae tincidunt euismod, arcu justo viverra enim, vel maximus orci ipsum eu libero. Phasellus bibendum ullamcorper ligula. Nunc mauris nulla, dictum porttitor vehicula sed, tincidunt non dolor. Etiam a porta mi, non scelerisque enim. Etiam vel massa tempus, blandit erat eget, pulvinar augue. Cras facilisis justo vel urna egestas consequat. Donec rhoncus tincidunt malesuada. Fusce sit amet volutpat quam. Integer faucibus, turpis id efficitur tempor, ante lorem commodo tortor, et eleifend metus odio iaculis orci. Duis nisl nulla, semper et arcu et, rutrum interdum ipsum. 

# Duomenys
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam convallis mauris id commodo rutrum. Ut ultrices, nisl non maximus pulvinar, risus risus vehicula nulla, ullamcorper lacinia orci ligula ac neque. Suspendisse lacinia, erat vitae tincidunt euismod, arcu justo viverra enim, vel maximus orci ipsum eu libero. Phasellus bibendum ullamcorper ligula. Nunc mauris nulla, dictum porttitor vehicula sed, tincidunt non dolor. Etiam a porta mi, non scelerisque enim. Etiam vel massa tempus, blandit erat eget, pulvinar augue. Cras facilisis justo vel urna egestas consequat. Donec rhoncus tincidunt malesuada. Fusce sit amet volutpat quam. Integer faucibus, turpis id efficitur tempor, ante lorem commodo tortor, et eleifend metus odio iaculis orci. Duis nisl nulla, semper et arcu et, rutrum interdum ipsum. 

# Pasaulinė statistika {.tabset .tabset-fade .tabset-pills}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam convallis mauris id commodo rutrum. Ut ultrices, nisl non maximus pulvinar, risus risus vehicula nulla, ullamcorper lacinia orci ligula ac neque. Suspendisse lacinia, erat vitae tincidunt euismod, arcu justo viverra enim, vel maximus orci ipsum eu libero. Phasellus bibendum ullamcorper ligula. Nunc mauris nulla, dictum porttitor vehicula sed, tincidunt non dolor. Etiam a porta mi, non scelerisque enim. Etiam vel massa tempus, blandit erat eget, pulvinar augue. Cras facilisis justo vel urna egestas consequat. Donec rhoncus tincidunt malesuada. Fusce sit amet volutpat quam. Integer faucibus, turpis id efficitur tempor, ante lorem commodo tortor, et eleifend metus odio iaculis orci. Duis nisl nulla, semper et arcu et, rutrum interdum ipsum. 

## Žemėlapis{.tabset .tabset-fade .tabset-pills}
### Žemėlapis 1
```{r, echo=FALSE}
data_world <- read.csv("./data/data_world.csv",
                       stringsAsFactors = FALSE)%>%
        mutate(date=as.Date(date))%>%
        mutate(var=factor(var, levels=c("active", "recovered", "deaths")))%>%
        filter(var!="confirmed")%>%
        group_by(date, var)%>%
        summarise(value=sum(value))

max.date <- max(data_world$date)


ggplot(data_world, aes(x=date, y=value, fill=var))+
        geom_area(alpha=0.5)+
        scale_fill_manual(values=c("red", "green", "black"))+ 
        scale_x_date(breaks="1 week")+
        scale_y_continuous(breaks =pretty_breaks())+
        labs(title=paste0("COVID-19 (last update ", max.date,")"),
             subtitle = "Source: 2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns Hopkins CSSE",
             x="Date",
             y="Count")+
        theme(legend.title=element_blank(),
              legend.position='bottom',
              axis.text.x = element_text(angle = 45, hjust = 1))
```

### Žemėlapis 2
### Žemėlapis 3
### Žemėlapis 4





## Top 10 šalių



# Europos statistika {.tabset .tabset-fade .tabset-pills}
## Žemėlapis {.tabset .tabset-fade .tabset-pills}
### Žemėlapis 1
```{r, echo=FALSE}
library(RColorBrewer)
df <- read.csv("./data/data_world_map.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)%>%
        mutate(date=as.Date(date))%>%
    filter(var=="confirmed",
           date==max(date))

shape <- get_eurostat_geospatial(output_class = "sf", resolution = "20", nuts_level = "0")

df <- left_join(shape, df, by="CNTR_CODE")

ggplot(df, aes(fill=value))+
  geom_sf()+
 scale_fill_gradientn(colours=rev(brewer.pal(10,"Spectral")))+
   labs(title=paste0("Suminis korona virusu apsikrėtusiųjų skaičius (duomenys ", max.date,")"),
             subtitle = "Šaltinis: corona-stat.lt")+
  xlim(c(-23,29))+
  ylim(c(35,70))
```



# Lietuva {.tabset .tabset-fade .tabset-pills}
## Žemėlapis
```{r, echo=FALSE}
library(RColorBrewer)
df <- read.csv("./data/data_lt_county_cum.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)%>%
        mutate(date=as.Date(date))%>%
    filter(var=="confirmed",
           date==max(date))

shape <- get_eurostat_geospatial(output_class = "sf", resolution = "60", nuts_level = "3")%>%
  filter(CNTR_CODE=="LT")

df <- left_join(shape, df, by="NUTS_ID")

ggplot(df, aes(fill=values))+
  geom_sf()+
 scale_fill_gradientn(colours=rev(brewer.pal(10,"Spectral")))+
   labs(title=paste0("Suminis korona virusu apsikrėtusiųjų skaičius (duomenys ", max.date,")"),
             subtitle = "Šaltinis: corona-stat.lt")
```


# Ekonomika {.tabset .tabset-fade .tabset-pills}
## BVP
## Pramonės produkcija
## Užsienio prekyba
## Mažmeninė preyba
## Infliacija
## Kreditai
## Užimtumas / nedarbas

# Prognozės

